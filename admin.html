<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FilePortal - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .login-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateX(-20px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }

        .portal-hidden {
            display: none;
        }

        /* File Management Styles */
        .upload-area {
            border: 2px dashed #cbd5e1;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #3b82f6;
            background-color: #f8fafc;
        }
        .upload-area.dragover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        
        .user-gradient {
            background: linear-gradient(to right, #667eea, #764ba2);
        }
        
        .admin-gradient {
            background: linear-gradient(to right, #f093fb, #f5576c);
        }

        .file-item {
            transition: all 0.3s ease;
        }
        
        .file-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        /* Login Toggle Switch Styles */
        .login-toggle-switch {
            position: relative;
            width: 320px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            padding: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .login-toggle-slider {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 156px;
            height: 52px;
            background: white;
            border-radius: 26px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .login-toggle-switch.admin-mode .login-toggle-slider {
            transform: translateX(156px);
        }
        
        .login-toggle-option {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            z-index: 2;
            width: 156px;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .login-toggle-option.user-option {
            left: 4px;
        }
        
        .login-toggle-option.admin-option {
            right: 4px;
        }
        
        .login-toggle-switch .login-toggle-option.active {
            color: #4f46e5;
        }
        
        .login-toggle-switch.admin-mode .user-option {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .login-toggle-switch.admin-mode .admin-option {
            color: #f5576c;
        }

        /* Login Form Card Styles */
        .login-form-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.5s ease;
        }
        
        .login-form-card.admin-mode {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container flex items-center justify-center p-4">
        <div class="max-w-4xl w-full">
            <!-- Header -->
            <div class="text-center mb-12 fade-in">
                <h1 class="text-5xl font-bold text-white mb-4">FilePortal</h1>
                <p class="text-xl text-white/80">Secure file management for teams</p>
            </div>

            <!-- Login Mode Toggle -->
            <div class="flex justify-center mb-8 fade-in" style="animation-delay: 0.3s;">
                <div class="login-toggle-switch" id="loginToggle">
                    <div class="login-toggle-slider"></div>
                    <div class="login-toggle-option user-option">ðŸ‘¤ User Login</div>
                    <div class="login-toggle-option admin-option">ðŸ”§ Admin Login</div>
                </div>
            </div>

            <!-- Login Form -->
            <div class="max-w-md mx-auto mb-8">
                <!-- Single Login Form -->
                <div class="login-form-card rounded-2xl p-8 text-white slide-in" id="loginCard">
                    <div class="text-center mb-6" id="loginHeader">
                        <div class="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4" id="loginIcon">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-2xl font-bold mb-2" id="loginTitle">User Login</h3>
                        <p class="text-white/80" id="loginSubtitle">Access your personal files</p>
                    </div>
                    
                    <div class="space-y-4" id="loginForm">
                        <div>
                            <input type="text" placeholder="Username" class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50" id="loginUsername">
                        </div>
                        <div>
                            <input type="password" placeholder="Password" class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50" id="loginPassword">
                        </div>
                        <button class="w-full bg-white py-3 rounded-lg font-semibold hover:bg-white/90 transition-colors" id="loginButton" onclick="performLogin()">
                            Sign In as User
                        </button>
                    </div>
                </div>
            </div>

            <!-- Demo Credentials -->
            <div class="text-center text-white/70 fade-in" style="animation-delay: 0.4s;">
                <p class="text-sm mb-2">Demo Credentials:</p>
                <p class="text-xs">User: user/password | Admin: admin/admin123</p>
            </div>
        </div>
    </div>

    <!-- Excel Upload Page (Hidden Initially) -->
    <div id="uploadPage" class="portal-hidden">
        <!-- Navigation Header -->
        <nav class="bg-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center">
                        <h1 class="text-2xl font-bold text-gray-800">FilePortal - Excel Upload</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <!-- User Profile -->
                        <div class="flex items-center space-x-2">
                            <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                                <span class="text-white text-sm font-semibold" id="uploadUserInitials">JD</span>
                            </div>
                            <span class="text-gray-700 font-medium" id="uploadUserName">John Doe</span>
                            <span class="text-sm text-gray-500" id="uploadUserRole">(User)</span>
                        </div>
                        
                        <!-- Logout Button -->
                        <button onclick="logoutFromUpload()" class="text-gray-600 hover:text-gray-800 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Upload Content -->
        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <!-- Welcome Section -->
                <div class="text-center mb-12 fade-in">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4" id="uploadWelcomeTitle">Excel File Upload Center</h2>
                    <p class="text-xl text-gray-600" id="uploadWelcomeSubtitle">Upload and manage your Excel files securely</p>
                </div>

                <!-- Upload Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full user-gradient">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Files Uploaded</p>
                                <p class="text-2xl font-semibold text-gray-900" id="uploadCount">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full user-gradient">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                                </svg>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Total Size</p>
                                <p class="text-2xl font-semibold text-gray-900" id="totalSize">0 MB</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full user-gradient">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                                </svg>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Processing</p>
                                <p class="text-2xl font-semibold text-gray-900" id="processingCount">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Upload Area -->
                <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 fade-in">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Upload Excel Files</h3>
                        <p class="text-gray-600">Drag and drop your Excel files or click to browse</p>
                    </div>
                    
                    <div class="upload-area rounded-xl p-12 text-center border-2 border-dashed border-gray-300 hover:border-blue-400 transition-colors" id="mainUploadArea">
                        <div class="mb-6">
                            <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <h4 class="text-xl font-semibold text-gray-700 mb-2">Drop Excel files here</h4>
                            <p class="text-gray-500 mb-4">or click to select files from your computer</p>
                        </div>
                        
                        <button class="user-gradient text-white px-8 py-3 rounded-lg font-semibold text-lg hover:opacity-90 transition-opacity shadow-lg" id="mainUploadBtn">
                            Choose Excel Files
                        </button>
                        
                        <div class="mt-6 text-sm text-gray-500">
                            <p class="mb-1"><strong>Supported formats:</strong> .xlsx, .xls, .csv</p>
                            <p><strong>Maximum file size:</strong> 100MB per file</p>
                        </div>
                        
                        <input type="file" id="mainFileInput" class="hidden" multiple accept=".xlsx,.xls,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/csv">
                    </div>
                </div>

                <!-- Upload Progress -->
                <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 fade-in" id="uploadProgressSection" style="display: none;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Upload Progress</h3>
                    <div id="uploadProgressList" class="space-y-3">
                        <!-- Progress items will be added here -->
                    </div>
                </div>

                <!-- Uploaded Files List -->
                <div class="bg-white rounded-2xl shadow-xl p-8 fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">Uploaded Files</h3>
                        <div class="flex space-x-2">
                            <button class="px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors rounded-lg hover:bg-gray-100">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                                </svg>
                            </button>
                            <button class="px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors rounded-lg hover:bg-gray-100">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-4" id="uploadedFilesList">
                        <!-- Empty State -->
                        <div class="text-center py-16" id="uploadEmptyState">
                            <svg class="mx-auto h-20 w-20 text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <h3 class="text-xl font-medium text-gray-500 mb-2">No Excel files uploaded yet</h3>
                            <p class="text-gray-400">Upload your first Excel file to get started with data processing</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <script>
        let currentUserRole = null;
        let currentUserName = null;
        let currentLoginMode = 'user'; // Track current login mode

        // Toggle login mode
        function toggleLoginMode() {
            const loginToggle = document.getElementById('loginToggle');
            const loginCard = document.getElementById('loginCard');
            const loginTitle = document.getElementById('loginTitle');
            const loginSubtitle = document.getElementById('loginSubtitle');
            const loginButton = document.getElementById('loginButton');
            const loginIcon = document.getElementById('loginIcon');
            const userOption = document.querySelector('.user-option');
            const adminOption = document.querySelector('.admin-option');

            if (currentLoginMode === 'user') {
                // Switch to admin mode
                currentLoginMode = 'admin';
                loginToggle.classList.add('admin-mode');
                loginCard.classList.add('admin-mode');
                loginTitle.textContent = 'Admin Login';
                loginSubtitle.textContent = 'Manage system and users';
                loginButton.textContent = 'Sign In as Admin';
                loginButton.className = 'w-full bg-white text-pink-600 py-3 rounded-lg font-semibold hover:bg-white/90 transition-colors';
                
                // Update icon to admin
                loginIcon.innerHTML = `
                    <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                `;
                
                userOption.classList.remove('active');
                adminOption.classList.add('active');
                
            } else {
                // Switch to user mode
                currentLoginMode = 'user';
                loginToggle.classList.remove('admin-mode');
                loginCard.classList.remove('admin-mode');
                loginTitle.textContent = 'User Login';
                loginSubtitle.textContent = 'Access your personal files';
                loginButton.textContent = 'Sign In as User';
                loginButton.className = 'w-full bg-white text-purple-600 py-3 rounded-lg font-semibold hover:bg-white/90 transition-colors';
                
                // Update icon to user
                loginIcon.innerHTML = `
                    <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                `;
                
                adminOption.classList.remove('active');
                userOption.classList.add('active');
            }

            // Clear form fields when switching
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }

        // Perform login based on current mode
        function performLogin() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            // Demo credentials validation
            const validCredentials = {
                user: { username: 'user', password: 'password' },
                admin: { username: 'admin', password: 'admin123' }
            };

            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }

            if (username === validCredentials[currentLoginMode].username && password === validCredentials[currentLoginMode].password) {
                currentUserRole = currentLoginMode;
                currentUserName = currentLoginMode === 'admin' ? 'Admin User' : 'John Doe';
                
                // Show success message and redirect to upload page
                alert(`Login successful! Welcome ${currentUserName}!`);
                
                // Simulate page redirect by hiding login and showing upload page
                setTimeout(() => {
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('uploadPage').classList.remove('portal-hidden');
                    setupUploadPage(currentLoginMode);
                }, 1000);
                
            } else {
                alert('Invalid credentials. Please try again.');
            }
        }

        // Setup upload page based on role
        function setupUploadPage(role) {
            const uploadUserName = document.getElementById('uploadUserName');
            const uploadUserInitials = document.getElementById('uploadUserInitials');
            const uploadUserRole = document.getElementById('uploadUserRole');
            const uploadWelcomeTitle = document.getElementById('uploadWelcomeTitle');
            const uploadWelcomeSubtitle = document.getElementById('uploadWelcomeSubtitle');

            // Update user info
            uploadUserName.textContent = currentUserName;
            uploadUserInitials.textContent = currentUserName.split(' ').map(n => n[0]).join('');
            uploadUserRole.textContent = `(${role.charAt(0).toUpperCase() + role.slice(1)})`;

            if (role === 'admin') {
                uploadWelcomeTitle.textContent = 'Admin Excel Upload Center';
                uploadWelcomeSubtitle.textContent = 'Upload and manage Excel files for all users';
                
                // Update gradients to admin theme
                const gradients = document.querySelectorAll('#uploadPage .user-gradient');
                gradients.forEach(el => {
                    el.classList.remove('user-gradient');
                    el.classList.add('admin-gradient');
                    el.style.background = 'linear-gradient(to right, #f093fb, #f5576c)';
                });
            } else {
                uploadWelcomeTitle.textContent = 'Excel File Upload Center';
                uploadWelcomeSubtitle.textContent = 'Upload and manage your Excel files securely';
            }
        }

        // Logout from upload page
        function logoutFromUpload() {
            if (confirm('Are you sure you want to logout?')) {
                // Reset form fields
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                
                // Reset login mode to user
                currentLoginMode = 'user';
                const loginToggle = document.getElementById('loginToggle');
                const loginCard = document.getElementById('loginCard');
                loginToggle.classList.remove('admin-mode');
                loginCard.classList.remove('admin-mode');
                document.querySelector('.admin-option').classList.remove('active');
                document.querySelector('.user-option').classList.add('active');
                
                // Reset upload page gradients
                const gradients = document.querySelectorAll('#uploadPage .admin-gradient');
                gradients.forEach(el => {
                    el.classList.remove('admin-gradient');
                    el.classList.add('user-gradient');
                    el.style.background = 'linear-gradient(to right, #667eea, #764ba2)';
                });
                
                // Show login page and hide upload page
                document.getElementById('uploadPage').classList.add('portal-hidden');
                document.getElementById('loginPage').style.display = 'flex';
                
                currentUserRole = null;
                currentUserName = null;
            }
        }

        // Initialize upload functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Set up login toggle click event
            const loginToggle = document.getElementById('loginToggle');
            loginToggle.addEventListener('click', toggleLoginMode);
            
            // Initialize user option as active
            document.querySelector('.user-option').classList.add('active');


            // Upload page functionality
            const mainUploadArea = document.getElementById('mainUploadArea');
            const mainFileInput = document.getElementById('mainFileInput');
            const mainUploadBtn = document.getElementById('mainUploadBtn');
            let uploadedFiles = [];
            let uploadStats = { count: 0, totalSize: 0, processing: 0 };

            if (mainUploadBtn) {
                mainUploadBtn.addEventListener('click', () => {
                    mainFileInput.click();
                });

                mainUploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    mainUploadArea.classList.add('dragover');
                    mainUploadArea.style.borderColor = '#3b82f6';
                    mainUploadArea.style.backgroundColor = '#eff6ff';
                });

                mainUploadArea.addEventListener('dragleave', () => {
                    mainUploadArea.classList.remove('dragover');
                    mainUploadArea.style.borderColor = '';
                    mainUploadArea.style.backgroundColor = '';
                });

                mainUploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    mainUploadArea.classList.remove('dragover');
                    mainUploadArea.style.borderColor = '';
                    mainUploadArea.style.backgroundColor = '';
                    const files = e.dataTransfer.files;
                    handleUploadFiles(files);
                });

                mainFileInput.addEventListener('change', (e) => {
                    handleUploadFiles(e.target.files);
                });
            }

            function handleUploadFiles(files) {
                const allowedTypes = [
                    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', // .xlsx
                    'application/vnd.ms-excel', // .xls
                    'text/csv' // .csv
                ];
                
                const allowedExtensions = ['.xlsx', '.xls', '.csv'];
                
                for (let file of files) {
                    const fileExtension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'));
                    
                    if (!allowedTypes.includes(file.type) && !allowedExtensions.includes(fileExtension)) {
                        alert(`Error: "${file.name}" is not an Excel file. Please upload only .xlsx, .xls, or .csv files.`);
                        continue;
                    }
                    
                    if (file.size > 100 * 1024 * 1024) { // 100MB limit
                        alert(`Error: "${file.name}" is too large. Maximum file size is 100MB.`);
                        continue;
                    }
                    
                    // Add to processing
                    uploadStats.processing++;
                    updateUploadStats();
                    
                    // Show progress
                    showUploadProgress(file);
                    
                    // Simulate file upload
                    setTimeout(() => {
                        completeFileUpload(file);
                    }, 2000 + Math.random() * 3000); // Random delay 2-5 seconds
                }
            }

            function showUploadProgress(file) {
                const progressSection = document.getElementById('uploadProgressSection');
                const progressList = document.getElementById('uploadProgressList');
                
                progressSection.style.display = 'block';
                
                const progressItem = document.createElement('div');
                progressItem.className = 'bg-gray-50 rounded-lg p-4 border';
                progressItem.id = `progress-${file.name.replace(/[^a-zA-Z0-9]/g, '')}`;
                
                progressItem.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="font-medium text-gray-800">${file.name}</span>
                        </div>
                        <span class="text-sm text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <div class="text-sm text-gray-600 mt-1">Uploading...</div>
                `;
                
                progressList.appendChild(progressItem);
                
                // Animate progress
                const progressBar = progressItem.querySelector('.bg-blue-600');
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 95) progress = 95;
                    progressBar.style.width = progress + '%';
                }, 200);
                
                // Store interval for cleanup
                progressItem.dataset.interval = interval;
            }

            function completeFileUpload(file) {
                const progressItem = document.getElementById(`progress-${file.name.replace(/[^a-zA-Z0-9]/g, '')}`);
                
                if (progressItem) {
                    // Complete progress bar
                    const progressBar = progressItem.querySelector('.bg-blue-600');
                    const statusText = progressItem.querySelector('.text-sm.text-gray-600');
                    
                    clearInterval(progressItem.dataset.interval);
                    progressBar.style.width = '100%';
                    progressBar.classList.remove('bg-blue-600');
                    progressBar.classList.add('bg-green-500');
                    statusText.textContent = 'Upload complete!';
                    statusText.classList.remove('text-gray-600');
                    statusText.classList.add('text-green-600');
                    
                    // Remove progress item after delay
                    setTimeout(() => {
                        progressItem.remove();
                        if (document.getElementById('uploadProgressList').children.length === 0) {
                            document.getElementById('uploadProgressSection').style.display = 'none';
                        }
                    }, 2000);
                }
                
                // Add to uploaded files
                const fileData = {
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    uploadDate: new Date(),
                    id: Date.now() + Math.random()
                };
                
                uploadedFiles.push(fileData);
                
                // Update stats
                uploadStats.processing--;
                uploadStats.count++;
                uploadStats.totalSize += file.size;
                updateUploadStats();
                
                // Update file list
                updateUploadedFilesList();
                
                // Show success message
                setTimeout(() => {
                    alert(`Excel file "${file.name}" uploaded successfully!`);
                }, 500);
            }

            function updateUploadStats() {
                document.getElementById('uploadCount').textContent = uploadStats.count;
                document.getElementById('totalSize').textContent = (uploadStats.totalSize / 1024 / 1024).toFixed(1) + ' MB';
                document.getElementById('processingCount').textContent = uploadStats.processing;
            }

            function updateUploadedFilesList() {
                const filesList = document.getElementById('uploadedFilesList');
                const emptyState = document.getElementById('uploadEmptyState');
                
                if (uploadedFiles.length === 0) {
                    emptyState.style.display = 'block';
                    return;
                }
                
                emptyState.style.display = 'none';
                
                filesList.innerHTML = uploadedFiles.map(file => `
                    <div class="file-item bg-gray-50 rounded-lg p-4 border hover:shadow-md transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800">${file.name}</h4>
                                    <p class="text-sm text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB â€¢ Uploaded ${file.uploadDate.toLocaleString()}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button class="px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors">
                                    View
                                </button>
                                <button class="px-3 py-1 text-sm bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors">
                                    Download
                                </button>
                                <button class="px-3 py-1 text-sm bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors" onclick="deleteFile('${file.id}')">
                                    Delete
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            // Global function for file deletion
            window.deleteFile = function(fileId) {
                if (confirm('Are you sure you want to delete this file?')) {
                    uploadedFiles = uploadedFiles.filter(file => file.id != fileId);
                    const deletedFile = uploadedFiles.find(file => file.id == fileId);
                    if (deletedFile) {
                        uploadStats.count--;
                        uploadStats.totalSize -= deletedFile.size;
                        updateUploadStats();
                    }
                    updateUploadedFilesList();
                }
            };


        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d090d497785a1d',t:'MTc1NDg0MDE1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
